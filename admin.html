<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>予約設定（管理者用）</title>
</head>
<body>
  <h1>予約日設定</h1>
  <label>日付（例：2025-06-10）<input type="text" id="date"></label><br>
  <label>初心者上限 <input type="number" id="beginner" value="2"></label><br>
  <label>経験者上限 <input type="number" id="experienced" value="2"></label><br>
  <button onclick="saveConfig()">予約可能にする</button>

  <p id="status"></p>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.0/firebase-app.js";
    import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/11.8.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC3pcdWqFwrvokCUyGGJlg_ruQ-6wUSZT8",
      authDomain: "tsta-reserve.firebaseapp.com",
      projectId: "tsta-reserve",
      storageBucket: "tsta-reserve.firebasestorage.app",
      messagingSenderId: "242251329752",
      appId: "1:242251329752:web:f70718703ba8e35298a7ad"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function saveConfig() {
      const date = document.getElementById('date').value;
      const beginner = parseInt(document.getElementById('beginner').value);
      const experienced = parseInt(document.getElementById('experienced').value);
      if (!date) return alert("日付を入力してください");

      const config = {
        enabled: true,
        beginner_limit: beginner,
        experienced_limit: experienced
      };

      try {
        await setDoc(doc(db, "config", date), config);
        document.getElementById("status").textContent = `${date} の設定を保存しました`;
      } catch (e) {
        console.error("Firestore 保存エラー:", e);
        document.getElementById("status").textContent = `保存に失敗しました`;
      }
    }
  </script>
</body>
</html>
